<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trình Tạo Mã QR và Mã Vạch</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        /* Các hiệu ứng CSS */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f4f7fb;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding: 10px;
        }

        .container {
            background-color: #ffffff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px;
            text-align: center;
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }

        .header {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        input, select, button {
            font-size: 16px;
        }

        .btn-custom {
            background-color: #007bff;
            color: white;
            padding: 10px 15px;
            width: 100%;
            font-size: 16px;
        }

        .btn-custom:hover {
            background-color: #0056b3;
        }

        #output {
            margin-top: 15px;
        }

        #downloadButtons {
            display: none;
            margin-top: 15px;
        }

        .download-btn {
            background-color: #28a745;
            color: white;
            padding: 10px 15px;
            margin: 5px 0;
            font-size: 14px;
            border: none;
            border-radius: 5px;
            width: 100%;
        }

        .download-btn:hover {
            background-color: #218838;
        }

        .form-text {
            font-size: 14px;
            color: #6c757d;
        }

        .form-control {
            padding: 10px;
        }

        @media (min-width: 768px) {
            .container {
                padding: 30px;
            }

            .header {
                font-size: 28px;
                margin-bottom: 20px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .btn-custom {
                padding: 12px 20px;
            }

            .download-btn {
                padding: 10px 20px;
                margin: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">Trình Tạo Mã QR và Mã Vạch</div>

        <div class="form-group"></div>
            <label for="inputText">Nhập thông tin (Chữ, URL, Số điện thoại,...)</label>
            <input type="text" class="form-control" id="inputText" placeholder="Nhập thông tin cần tạo mã QR hoặc mã vạch">
            <small id="textHelp" class="form-text text-muted">Bạn có thể nhập URL, văn bản hoặc số.</small>
        </div>

        <div class="form-group">
            <label for="qrOption">Chọn loại mã:</label>
            <select id="qrOption" class="form-select">
                <option value="qr">QR Code</option>
                <option value="barcode">Mã Vạch</option>
            </select>
        </div>

        <div class="form-group">
            <label for="inputType">Chọn loại dữ liệu:</label>
            <select id="inputType" class="form-select">
                <option value="text">Văn bản</option>
                <option value="url">URL</option>
                <option value="phone">Số điện thoại</option>
            </select>
        </div>

        <button id="generateBtn" class="btn btn-custom">Tạo Mã</button>

        <div id="output"></div>

        <div id="downloadButtons" class="download-buttons"></div>
            <button class="download-btn" id="downloadPng">Tải PNG</button>
            <button class="download-btn" id="downloadJpeg">Tải JPEG</button>
            <button class="download-btn" id="downloadPdf">Tải PDF</button>
        </div>
    </div>

    <!-- QRCode.js và JsBarcode, jsPDF -->
    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.0/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        // Sự kiện tạo mã khi người dùng click vào nút "Tạo Mã"
        document.getElementById('generateBtn').addEventListener('click', function() {
            var inputText = document.getElementById('inputText').value;
            var qrOption = document.getElementById('qrOption').value;
            var inputType = document.getElementById('inputType').value;

            if (inputText.trim() === '') {
                alert('Vui lòng nhập thông tin cần tạo mã!');
                return;
            }

            // Xóa mã QR/Mã vạch cũ
            document.getElementById('output').innerHTML = '';
            document.getElementById('downloadButtons').style.display = 'none';

            // Chỉnh sửa dữ liệu đầu vào nếu là URL hoặc Số điện thoại
            if (inputType === 'url') {
                if (!inputText.startsWith('http://') && !inputText.startsWith('https://')) {
                    inputText = 'http://' + inputText;
                }
            } else if (inputType === 'phone') {
                inputText = 'tel:' + inputText;
            }

            // Tạo mã QR hoặc mã vạch
            if (qrOption === 'qr') {
                // Tạo mã QR
                var qr = new QRCode(document.getElementById("output"), {
                    text: inputText,
                    width: 256,
                    height: 256,
                    colorDark : "#000000",
                    colorLight : "#ffffff",
                    correctLevel : QRCode.CorrectLevel.H
                });
            } else {
                // Tạo mã vạch
                JsBarcode("#output", inputText, {
                    format: "CODE128",
                    lineColor: "#000000",
                    width: 3,
                    height: 100,
                    displayValue: true
                });
            }

            // Hiển thị các nút tải xuống
            document.getElementById('downloadButtons').style.display = 'block';
        });

        // Tải ảnh PNG/JPEG
        function downloadImage(format) {
            var canvas = document.querySelector('canvas');
            if (canvas) {
                var img = canvas.toDataURL('image/' + format);
                var link = document.createElement('a');
                link.href = img;
                link.download = 'generated_code.' + format;
                link.click();
            }
        }

        // Tải PNG
        document.getElementById('downloadPng').addEventListener('click', function() {
            downloadImage('png');
        });

        // Tải JPEG
        document.getElementById('downloadJpeg').addEventListener('click', function() {
            downloadImage('jpeg');
        });

        // Tải PDF
        document.getElementById('downloadPdf').addEventListener('click', function() {
            const { jsPDF } = window.jspdf;
            var canvas = document.querySelector('canvas');
            if (canvas) {
                var imgData = canvas.toDataURL('image/png');
                const doc = new jsPDF();
                doc.addImage(imgData, 'PNG', 10, 10, 180, 180);
                doc.save('generated_code.pdf');
            }
        });
    </script>
</body>
</html>
